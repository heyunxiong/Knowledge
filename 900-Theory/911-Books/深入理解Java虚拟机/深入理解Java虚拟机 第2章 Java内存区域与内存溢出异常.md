第二部分 自动内存管理
# 第2章 Java内存区域与内存溢出异常

## 2.2 运行时数据区域
Java虚拟机在执行java程序的过程中，会把它管理的内存划分为若干个不同的数据区域

Java虚拟机管理的运行时数据区
![[_assets/深入理解Java虚拟机 第2章 Java内存区域与内存溢出异常/Diagram.svg]]

### 程序计数器 program counter register
是什么？
一块较小的内存空间，可以看作是当前线程所执行的字节码的行号指示器；
做什么？
通过改变计数器的值来选取下一条要执行的字节码指令，是程序控制流的指示器，分支、循环、跳转，线程恢复都需要依赖计数器；
特别的？
唯一一个没有OutOfMemoryError的区域，线程私有的内存

### java虚拟机栈 java virtual machine stack
是什么？
java方法执行的线程内存模型：每个方法被执行的时候，java虚拟机都会同步创建一个栈帧stack frame，用于存储局部变量表、操作数栈、动态连接、方法出口等信息
做什么？
每一个方法被调用直至执行完毕的过程，就对应着一个栈帧在虚拟机栈中从入栈到出栈的过程
特别的？
线程私有，生命周期和线程一样；java中所说的堆栈的栈就是虚拟机栈，或者更具体是指虚拟机栈中的局部变量表；会爆OOM，SO（StackOverflowError）

### 本地方法栈 native method stacks
是什么？
和虚拟机栈类似
做什么？
本地方法栈为java虚拟机使用到本地方法服务，即系统方法
特别的？
会爆OOM，SO

### Java堆 java heap
是什么？
一大块被所有线程共享的内存区域
做什么
唯一目的就是存放对象实例
特别的
java堆是垃圾收集器管理的内存区域；
java堆可以处于物理上不连续的内存空间，逻辑视为连续
java堆内存大小可被扩展，扩展堆大小参数 -Xmx -Xms
会爆OOM

### 方法区 Method Area
是什么？
和堆一样，是一块各个线程共享的内存区域
做什么？
用于存储已被虚拟机加载的类型信息、常量、静态变量、即时编译器编译后的代码缓存等
特别的
被描述为堆的一个逻辑部分，别名：非堆 non-heap
可扩展大小，
物理上可不连续，逻辑连续
会爆OOM

### 运行时常量池 running constant pool
是什么
是方法区的一部分
做什么
存放Class文件中的常量池表信息，常量池表经过编译生成各种字面量和符号引用
特别的
作为方法区的一部分，限制和特点和方法区类似
会爆OOM

### 直接内存  direct memory
不是虚拟机运行时数据区的一部分，特指物理机内存

## 2.3 HotSpot 虚拟机中的对象

### 对象的创建

### 对象的内存布局

### 对象的访问定位

### OOM异常






